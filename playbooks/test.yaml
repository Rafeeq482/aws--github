---
- name: Test AWX connectivity to private instance via bastion
  hosts: private_server
  gather_facts: no
  tasks:

    - name: Print connection info
      ansible.builtin.debug:
        msg: |
          Trying to connect to {{ inventory_hostname }}
          ansible_user = {{ ansible_user }}
          ansible_host = {{ ansible_host }}
          ansible_ssh_common_args = {{ ansible_ssh_common_args | default("not defined") }}

    - name: Run simple ping
      ansible.builtin.ping:

    - name: Run whoami to verify shell access
      ansible.builtin.command: whoami
      register: whoami_output

    - name: Show whoami output
      ansible.builtin.debug:
        var: whoami_output.stdout
