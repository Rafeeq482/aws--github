---
- name: 🔐 Test Bastion PEM Key Injection
  hosts: localhost
  gather_facts: false
  tasks:

    - name: 🆔 Print current user UID
      ansible.builtin.command: id -u
      register: uid_output

    - name: 🔍 Show UID
      ansible.builtin.debug:
        msg: "{{ uid_output.stdout }}"

    - name: 🧪 List files in /runner/env/
      ansible.builtin.command: ls -l /runner/env/
      register: env_files

    - name: 🔍 Show files in /runner/env/
      ansible.builtin.debug:
        var: env_files.stdout_lines

    - name: 🔧 Fix permission for bastion key (no sudo)
      ansible.builtin.command: chmod 600 /runner/env/template.ssh_key_bastion

    - name: 🧪 Confirm Bastion Key Connection (if possible)
      ansible.builtin.command: echo "✅ Connected to Bastion Host"

